# 主力选股功能说明

## 功能概述

**主力选股**是一个智能选股系统，通过分析主力资金流向，结合AI多智能体分析，自动筛选出近期拉升概率高、主力资金净流入较多、综合素质优秀的优质投资标的。

## 核心特点

### 1. 数据来源权威
- 使用 `pywencai` 获取同花顺数据
- 主力资金流向真实可靠
- 包含完整的财务评分和行业信息

### 2. 智能筛选机制
- **主力资金排名**：优先选择主力资金净流入前100名
- **涨幅过滤**：排除涨幅过高的股票，避免追高
- **市值筛选**：聚焦50-1300亿市值区间的优质标的
- **基本面保护**：自动过滤ST股、科创板（可配置）

### 3. AI多维度分析
整合三大分析师团队：
- **💰 资金流向分析师**：分析主力资金行为和市场情绪
- **📊 行业板块分析师**：评估行业前景和市场热点
- **📈 财务基本面分析师**：考察盈利能力和财务健康度

### 4. 资深研究员决策
- AI研究员综合所有分析结果
- 从候选股票中精选最优标的
- 提供详细的推荐理由和风险提示

## 工作流程

```
┌─────────────────────────────────────────────────────────┐
│                    1. 数据获取                           │
│   使用pywencai获取主力资金净流入前100名股票              │
│   包含：资金流向、涨跌幅、市值、财务指标、行业等         │
└──────────────────┬──────────────────────────────────────┘
                   │
┌──────────────────▼──────────────────────────────────────┐
│                    2. 智能筛选                           │
│   ✓ 区间涨跌幅 < 30%（避免追高）                        │
│   ✓ 市值 50-1300亿（优质中盘股）                        │
│   ✓ 排除ST股和科创板                                    │
│   ✓ 按主力资金排序，取前20名                            │
└──────────────────┬──────────────────────────────────────┘
                   │
┌──────────────────▼──────────────────────────────────────┐
│                    3. AI深度分析                         │
│   对每只候选股票进行三维度分析：                         │
│   • 资金流向（主力行为、资金结构）                       │
│   • 行业板块（行业地位、市场热度）                       │
│   • 财务基本面（盈利能力、成长性）                       │
└──────────────────┬──────────────────────────────────────┘
                   │
┌──────────────────▼──────────────────────────────────────┐
│                    4. 综合决策                           │
│   资深研究员AI综合评估：                                │
│   • 对比所有候选股票                                    │
│   • 精选3-5只最优标的                                   │
│   • 提供推荐理由、投资亮点、风险提示                     │
└─────────────────────────────────────────────────────────┘
```

## 使用方法

### 步骤1：进入主力选股界面

在系统侧边栏点击 **🎯 主力选股** 按钮

### 步骤2：设置参数

#### 基础参数
1. **时间区间**：选择数据统计的时间范围
   - 最近3个月（默认）
   - 最近6个月
   - 最近1年
   - 自定义日期

2. **初步筛选数量**：从符合条件的股票中选取前N名（默认20只）
   - 范围：10-50只
   - 建议：20-30只

3. **最终精选数量**：最终推荐的股票数量（默认5只）
   - 范围：3-10只
   - 建议：3-5只

#### 高级参数（可选）
4. **最大涨跌幅**：过滤涨幅过高的股票（默认30%）
   - 作用：避免追高
   - 建议：20%-40%

5. **市值范围**：
   - 最小市值：默认50亿
   - 最大市值：默认1300亿
   - 作用：聚焦优质中盘股

6. **AI模型**：选择分析使用的AI模型
   - `deepseek-chat`：速度快，适合快速筛选
   - `deepseek-reasoner`：推理能力强，分析更深入

### 步骤3：开始分析

点击 **🚀 开始主力选股** 按钮，系统将自动：
1. 获取数据（约30-60秒）
2. 智能筛选（约10秒）
3. AI深度分析（约2-5分钟，取决于股票数量）
4. 综合决策（约30秒）

### 步骤4：查看结果

#### 统计概览
显示四个关键指标：
- **获取股票数**：原始数据数量（通常100只）
- **筛选后**：符合筛选条件的数量
- **深度分析**：成功完成AI分析的数量
- **最终推荐**：精选的优质标的数量

#### 精选推荐
对每只推荐股票，系统提供：

1. **📌 推荐理由**（3-5条核心理由）
   - 为什么推荐这只股票
   - 关键优势是什么

2. **💡 投资亮点**
   - 突出的投资价值
   - 主要看点

3. **⚠️ 风险提示**
   - 需要关注的风险
   - 注意事项

4. **📊 投资建议**
   - 建议仓位：如20-30%
   - 目标价位：预期目标价
   - 投资周期：短期/中期/长期

5. **🤖 AI分析师详细报告**
   - 资金流向分析
   - 行业板块分析
   - 财务基本面分析

#### 候选股票列表
显示所有候选股票的详细数据：
- 股票代码、名称
- 所属行业
- 市值
- 主力资金净流入
- 区间涨跌幅
- 市盈率、市净率

支持下载CSV格式数据

## 筛选逻辑详解

### 主力资金标准
- **主力资金净流入排名**：选择资金流入最多的股票
- **资金持续性**：优先考虑持续流入的股票
- **资金占比**：主力资金占比高的更受关注

### 涨幅控制
```
✅ 涨幅适中（<30%）：
   - 还有上涨空间
   - 风险相对可控
   
❌ 涨幅过高（>30%）：
   - 可能面临回调压力
   - 追高风险较大
   - 自动过滤
```

### 市值要求
```
市值范围：50-1300亿

原因：
✓ <50亿：流动性差，风险高
✓ 50-1300亿：优质中盘股，兼顾成长性和稳定性
✓ >1300亿：大盘股，成长空间有限
```

### 基本面保护
- 自动排除ST股票（特别处理）
- 可配置排除科创板（波动较大）
- 要求财务数据完整

## AI分析维度

### 1. 资金流向分析
**分析内容**：
- 主力资金流向趋势
- 大单、中单、小单分布
- 机构与散户资金博弈
- 资金推动与股价配合度
- 换手率与成交活跃度

**评判标准**：
- ✅ 主力持续流入 + 股价上涨 = 强势信号
- ⚠️ 主力流出 + 股价上涨 = 警惕接盘
- 💡 主力流入 + 股价下跌 = 可能低吸
- ❌ 主力流出 + 股价下跌 = 弱势信号

### 2. 行业板块分析
**分析内容**：
- 所属行业发展前景
- 行业在市场中的地位
- 板块轮动和市场热度
- 政策支持和行业催化
- 行业竞争格局

**关注重点**：
- 行业是否处于上升周期
- 是否有政策利好支持
- 市场关注度和热度
- 行业龙头还是跟随者

### 3. 财务基本面分析
**分析内容**：
- 盈利能力（净利润、ROE等）
- 成长能力（营收增长、利润增长）
- 营运能力（周转率等）
- 偿债能力（资产负债率）
- 现金流状况
- 资产质量

**评分体系**：
系统获取8大评分：
1. 盈利能力评分
2. 成长能力评分
3. 营运能力评分
4. 偿债能力评分
5. 现金流评分
6. 资产质量评分
7. 流动性评分
8. 资本充足性评分

## 使用建议

### 适用场景
1. **中短期波段交易**
   - 捕捉主力资金推动的行情
   - 关注3个月内的主力行为

2. **行业轮动投资**
   - 发现市场热点板块
   - 把握资金流向切换

3. **价值成长投资**
   - 寻找被主力关注的潜力股
   - 结合基本面和资金面

### 使用频率
- **建议**：每周执行1-2次
- **最佳时机**：周末或交易日收盘后
- **避免**：开盘前或盘中（数据可能不完整）

### 注意事项

#### 1. 数据时效性
- 数据有一定延迟（通常1-2天）
- 适合中短期布局，不适合日内交易
- 建议结合实时行情确认

#### 2. 市场环境
- **牛市**：主力选股效果更佳，资金推动明显
- **震荡市**：关注短期波段机会
- **熊市**：谨慎使用，关注防御性板块

#### 3. 仓位管理
- 不要孤注一掷，建议分散投资
- 单只股票仓位不超过30%
- 保留一定现金仓位

#### 4. 风险控制
- 设置止损位（建议-8%到-10%）
- 设置止盈位（建议+15%到+20%）
- 不追高，不贪婪

## 常见问题

### Q1: 为什么获取数据失败？
**可能原因**：
1. 网络连接问题
2. pywencai服务暂时不可用
3. 查询语句触发限制

**解决方法**：
- 检查网络连接
- 等待片刻后重试
- 调整时间区间参数

### Q2: 为什么筛选后股票很少？
**可能原因**：
1. 筛选条件过于严格
2. 当前市场符合条件的股票较少

**解决方法**：
- 适当放宽涨跌幅限制（如改为40%）
- 扩大市值范围
- 调整时间区间

### Q3: AI分析需要多长时间？
**时间估算**：
- 单只股票：约10-15秒
- 20只股票：约3-5分钟
- 50只股票：约8-10分钟

**影响因素**：
- 股票数量
- AI模型选择
- 网络速度

### Q4: 推荐结果每次都一样吗？
**答案**：不完全一样

**原因**：
1. 数据每天更新（主力资金、价格等）
2. AI分析会考虑最新市场环境
3. 不同时间段的数据可能不同

### Q5: 如何判断推荐质量？
**评判标准**：
1. **理由充分性**：推荐理由是否具体、有说服力
2. **数据支撑**：是否有真实数据支撑
3. **风险提示**：是否明确指出风险
4. **逻辑连贯性**：资金、行业、基本面是否相互印证

**建议**：
- 认真阅读AI分析报告
- 对比多个候选股票
- 结合自己的投资逻辑
- 不盲目跟从，独立思考

## 技术要求

### 环境依赖
```bash
# 必须安装
pywencai>=0.7.0
pandas
streamlit

# Node.js要求
Node.js >= 16.0（pywencai依赖）
```

### 安装方法
```bash
# 安装Python依赖
pip install pywencai pandas streamlit

# 检查Node.js版本
node --version

# 如果版本低于16.0，需要升级Node.js
```

## 最佳实践

### 1. 每周选股流程
```
周日晚上 → 运行主力选股
           ↓
        查看推荐结果
           ↓
        深入研究前3名
           ↓
    周一开盘前制定策略
           ↓
        择机建仓
```

### 2. 结合技术分析
推荐股票后，建议再进行：
- K线形态分析
- 支撑压力位判断
- 均线系统确认
- 成交量变化观察

### 3. 分批建仓
```
发现优质标的后：
第1批：20% → 试探性建仓
第2批：30% → 确认后加仓
第3批：30% → 突破后追加
保留：20% → 备用资金
```

### 4. 持仓管理
```
持有期间关注：
✓ 主力资金是否继续流入
✓ 股价是否沿着上升趋势
✓ 行业是否仍有催化
✓ 基本面是否发生变化

出现以下情况考虑减仓：
✗ 主力资金持续流出
✗ 技术面破位
✗ 基本面恶化
✗ 达到目标价位
```

## 更新日志

### v1.0.0 (2025-10-09)
- ✅ 初始版本发布
- ✅ 支持主力资金数据获取
- ✅ 实现智能筛选算法
- ✅ 集成AI三大分析师
- ✅ 资深研究员综合决策
- ✅ Web界面集成

## 技术支持

如遇问题，请提供：
1. 错误截图或错误信息
2. 使用的参数配置
3. 操作步骤描述

## 免责声明

**重要提示**：
1. 本功能仅供学习和研究使用
2. 不构成任何投资建议
3. 股市有风险，投资需谨慎
4. 请根据自身情况做出投资决策
5. 盈亏自负，谨慎操作

---

**祝您投资顺利！** 🚀📈

