# 🤖 智能盯盘使用指南

## 📖 项目简介

**智能盯盘**是基于 DeepSeek AI 的A股自动化交易决策系统，支持：
- ✅ **DeepSeek AI决策** - 利用DeepSeek-V3强大的推理能力进行股票分析
- ✅ **A股T+1适配** - 完全遵循A股交易规则
- ✅ **miniQMT集成** - 支持实盘自动交易
- ✅ **实时监控** - 24/7持续监控股票并自动决策
- ✅ **邮件/Webhook通知** - 及时接收交易信号

## 🚀 快速开始

### 1. 环境配置

在项目根目录的 `.env` 文件中添加以下配置：

```bash
# DeepSeek API配置
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# miniQMT配置
QMT_ACCOUNT_ID=your_qmt_account_id
USE_SIMULATOR=true  # true=模拟交易, false=实盘交易

# 通知配置（可选）
NOTIFY_EMAIL=your_email@example.com
NOTIFY_WEBHOOK=https://your.webhook.url
```

### 2. 安装依赖

智能盯盘需要以下额外依赖：

```bash
pip install akshare  # A股数据获取
pip install xtquant  # miniQMT交易接口（可选，如使用实盘交易）
```

### 3. 启动程序

```bash
streamlit run app.py
```

进入主界面后，点击左侧菜单 **"策略分析"** → **"智能盯盘"**

## 💡 功能说明

### 📊 实时分析

输入股票代码（如：600519），点击"开始分析"，AI会：

1. **获取实时行情数据**
   - 当前价格、涨跌幅
   - 成交量、换手率
   - 技术指标（MA、MACD、RSI、KDJ、布林带等）
   - 主力资金流向（如有数据）

2. **AI决策分析**
   - 综合技术面、资金面判断
   - 给出 **买入(BUY)** / **卖出(SELL)** / **持有(HOLD)** 建议
   - 提供详细的决策理由（200-300字）
   - 建议仓位、止损位、止盈位

3. **自动执行（可选）**
   - 勾选"自动交易"，AI决策后自动下单
   - 支持T+1规则检查（今天买入的股票明天才能卖）

### 🎯 监控任务

添加监控任务后，系统会定期（如每5分钟）自动分析目标股票：

**添加任务步骤：**
1. 点击"添加新监控任务"
2. 填写任务名称、股票代码
3. 设置检查间隔（建议300秒）
4. 选择是否自动交易
5. 点击"添加任务"

**任务管理：**
- ▶️ **启动/停止** - 控制任务运行
- 🗑️ **删除** - 移除监控任务
- 查看运行状态

### 📈 持仓管理

查看当前持仓：
- 持仓列表：代码、名称、数量、成本价、现价、盈亏
- 快速操作：AI分析、卖出（需符合T+1规则）
- 账户概览：总资产、可用资金、总盈亏

### 📜 历史记录

- **AI决策历史** - 查看所有AI分析记录
- **交易记录** - 查看买入/卖出记录及盈亏
- **通知记录** - 查看发送的通知

## ⚙️ 系统设置

### DeepSeek API配置

1. 访问 [DeepSeek官网](https://www.deepseek.com) 注册账号
2. 获取API Key
3. 在系统设置中填写API Key

### miniQMT配置

**使用模拟交易（推荐新手）：**
- 勾选"使用模拟交易"
- 无需真实QMT账户
- 所有交易仅记录，不实际执行

**使用实盘交易（需要miniQMT）：**
1. 下载并安装 [miniQMT](https://www.xtp-mini.com/)
2. 启动miniQMT客户端
3. 获取账户ID
4. 在系统设置中填写账户ID
5. 取消勾选"使用模拟交易"

### 通知配置

**邮件通知：**
- 填写接收通知的邮箱地址
- 需在 `config.py` 中配置SMTP服务器

**Webhook通知：**
- 支持钉钉、企业微信、飞书等
- 填写Webhook URL
- 可自定义关键词触发

## 📚 AI决策逻辑说明

### 交易时段判断

系统会根据北京时间自动判断交易时段：

- **集合竞价** (9:00-9:30) - 不可交易，可观察
- **上午盘** (9:30-11:30) - 波动大，交易活跃
- **午间休市** (11:30-13:00) - 不可交易
- **下午盘** (13:00-14:30) - 波动趋缓
- **尾盘** (14:30-15:00) - 波动大，谨慎操作
- **盘后/周末** - 不可交易

### 买入信号（必须满足至少3个）

1. ✅ 趋势向上：价格 > MA5 > MA20 > MA60
2. ✅ 量价配合：成交量 > 5日均量的120%
3. ✅ MACD金叉：MACD > 0 且DIF上穿DEA
4. ✅ RSI健康：RSI在50-70区间
5. ✅ 突破关键位：突破前期高点或重要阻力位
6. ✅ 主力资金：净流入为正

### 卖出信号（满足任一立即卖出）

1. 🔴 止损触发：亏损 ≥ -5%
2. 🟢 止盈触发：盈利 ≥ +10%
3. 🔴 趋势转弱：跌破MA20/MA60，MACD死叉
4. 🔴 放量下跌：成交量放大但价格下跌
5. 🔴 技术破位：跌破重要支撑位

### T+1规则说明

⚠️ **关键限制**：
- 今天买入的股票，**今天不能卖出**
- 必须等到下一个交易日才能卖出
- 系统会自动检查并提示T+1限制

## ⚠️ 风险提示

1. **股市有风险，投资需谨慎**
2. AI决策仅供参考，不构成投资建议
3. 建议先使用模拟交易测试
4. 严格设置止损，控制单笔仓位（建议≤30%）
5. 不要投入超过承受能力的资金

## 🔧 故障排除

### Q: 提示"DeepSeek API调用失败"

**A:** 
- 检查API Key是否正确
- 检查网络连接
- 确认API账户余额充足

### Q: 提示"获取行情数据失败"

**A:**
- 检查网络连接
- akshare数据源可能暂时不可用
- 尝试更换股票代码测试

### Q: 提示"miniQMT未连接"

**A:**
- 如使用模拟交易，勾选"使用模拟交易"
- 如使用实盘，确保miniQMT客户端已启动
- 检查账户ID是否正确

### Q: 买入/卖出失败

**A:**
- 检查是否在交易时间（9:30-15:00）
- 检查资金是否充足
- 卖出时检查是否有可卖数量（T+1限制）
- 买入数量必须是100的整数倍

## 📞 技术支持

遇到问题或建议？

- 📧 邮箱：support@example.com
- 💬 Issue：在GitHub上提交Issue
- 📖 文档：查看 `docs/` 目录下的其他文档

---

**祝您交易顺利！🚀**

